#!/usr/bin/env node

var client = '../client'
var path = require('path')
var app = require('express')()
var static = require('serve-static')
var credential = require('config').mqtt.credential
var config = require('config').server
var mongo = require('config').mongodb
var http = require('http').Server(app)
var connection = require('../server/connection')

app.use('/', static(path.resolve(__dirname, client)))

http.listen(config.port, () => {
  console.log('Server listening at port %d', config.port)
})

mqtt = connection.mqtt(credential)
connection.subscribe(mqtt)

socket = connection.socket(http)
connection.emit_start(socket)

connection.mongodb(mongo.uri)



